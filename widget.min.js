const apiUrlBase="http://intensiv-widget.juliankern.com/beds",getApiUrl=a=>a?`${apiUrlBase}?lat=${a.latitude.toFixed(3)}&lng=${a.longitude.toFixed(3)}`:apiUrlBase;init();async function init(){const a=await createWidget();config.runsInWidget||(await a.presentSmall()),Script.setWidget(a),Script.complete()}async function createWidget(){const a=await getData(),b=new ListWidget,c=b.addText("\uD83D\uDECF Freie Intensivbetten");if(c.font=Font.mediumSystemFont(12),a){if(b.addSpacer(),a.state){const c=b.addText(a.state.used.toFixed(2)+"%");c.font=Font.mediumSystemFont(22),c.textColor=25>=a.state.used?Color.red():50>=a.state.used?Color.orange():Color.green();const d=b.addText(a.state.name);d.font=Font.lightSystemFont(12),b.addSpacer(4)}const c=b.addText(a.overall.used.toFixed(2)+"%");c.font=Font.mediumSystemFont(22),c.textColor=25>=a.overall.used?Color.red():50>=a.overall.used?Color.orange():Color.green();const d=b.addText("Deutschland");d.font=Font.lightSystemFont(12),b.refreshAfterDate=new Date(Date.now()+3600000),b.addSpacer(6);const e=new DateFormatter;e.useShortDateStyle(),e.useShortTimeStyle();const f=b.addText(`â†» ${e.string(new Date(a.overall.updated))}`);f.font=Font.lightSystemFont(9)}else b.addSpacer(),b.addText("Daten nicht verf\xFCgbar");return b}async function getData(){try{const a=await getLocation(),b=await new Request(getApiUrl(a)).loadJSON();return b}catch(a){return null}}async function getLocation(){try{if(args.widgetParameter){const a=args.widgetParameter.split(",").map(parseFloat);return{latitude:a[0],longitude:a[1]}}return Location.setAccuracyToThreeKilometers(),await Location.current()}catch(a){return null}}